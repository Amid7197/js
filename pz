# è¡Œä¸ºé”šç‚¹ï¼ˆå®šä¹‰ MRS æ ¼å¼ï¼Œä¸å½±å“é€»è¾‘ç›´è§‚æ€§ï¼‰
BehaviorDN: &BehaviorDN { type: http, interval: 86400, format: mrs, behavior: domain }
BehaviorIP: &BehaviorIP { type: http, interval: 86400, format: mrs, behavior: ipcidr }

# ä»£ç†ç»„é…ç½®
proxy-groups:
  - name: ğŸš€æ‰‹åŠ¨é€‰æ‹©
    type: select
    proxies:
      - ğŸŒäºšæ´²èŠ‚ç‚¹
      - ğŸ“¥ä½å€ç‡èŠ‚ç‚¹
      - ğŸ¯ç›´è¿
    use: [main, prepare]
    include-all: true # ä¿ç•™ï¼šæ­¤ç»„ä¸‹æ–¹ä¼šåˆ—å‡ºæ‰€æœ‰å•ä¸ªèŠ‚ç‚¹

  - name: ğŸŒäºšæ´²èŠ‚ç‚¹
    type: url-test
    url: 'https://www.google.com/generate_204'
    interval: 300
    tolerance: 50 # å‡å°‘é¢‘ç¹åˆ‡æ¢é€ æˆçš„æ–­è¿
    use: [main, prepare]
    filter: '(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|æ¸¯|hk|ğŸ‡¹ğŸ‡¼|å°æ¹¾|å°|tw|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|æ—¥|jp|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|æ–°|sg)(?!.*(ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ©|kr))'
    include-all: true 

  - name: ğŸ¤–Gemini
    type: fallback
    url: 'https://www.google.com/generate_204'
    interval: 300
    proxies:
      - æœºåœºgemini
      - å°æ¹¾-æ•…éšœè½¬ç§»
      - ç¾å›½-æ•…éšœè½¬ç§»
      - ğŸš€æ‰‹åŠ¨é€‰æ‹©

  - name: ğŸ“²Telegram
    type: select
    proxies:
      - ğŸš€æ‰‹åŠ¨é€‰æ‹©
      - ğŸ“¥ä½å€ç‡èŠ‚ç‚¹

  - name: ğŸ“¥ä½å€ç‡èŠ‚ç‚¹
    type: fallback
    url: 'https://www.google.com/generate_204'
    interval: 300
    use: [main, prepare]
    include-all: true
    filter: '(?i).*0\.(1|01).*'

  # --- è¾…åŠ©éšè—ç»„ï¼šæ­£åˆ™ç›´æ¥å±•ç¤º ---
  - name: å°æ¹¾-æ•…éšœè½¬ç§»
    type: fallback
    url: 'https://www.google.com/generate_204'
    interval: 100
    use: [main, prepare]
    include-all: true
    filter: '(?i)(ğŸ‡¹ğŸ‡¼|å°æ¹¾|å°|TW|taiwan|taipei)'
    hidden: true

  - name: ç¾å›½-æ•…éšœè½¬ç§»
    type: fallback
    url: 'https://www.google.com/generate_204'
    interval: 300
    use: [main, prepare]
    include-all: true
    filter: '(?i)(ğŸ‡ºğŸ‡¸|ç¾å›½|ç¾|US)'
    hidden: true

  - name: æœºåœºgemini
    type: fallback
    url: 'https://www.google.com/generate_204'
    interval: 100
    use: [main, prepare]
    include-all: true
    filter: '(?i)emini'
    hidden: true

  - name: ğŸ¯ç›´è¿
    type: select
    proxies: [ DIRECT, REJECT ]
    hidden: true

# è§„åˆ™é›†é…ç½®
rule-providers:
  China:          { <<: *BehaviorDN, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs }
  Gemini:         { <<: *BehaviorDN, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google-gemini.mrs }
  Telegram:       { <<: *BehaviorDN, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs }
  Lan:            { <<: *BehaviorDN, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs }
  
  ChinaIP:        { <<: *BehaviorIP, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs }
  TelegramIP:     { <<: *BehaviorIP, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs }
  LanIP:          { <<: *BehaviorIP, url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs }

# è§„åˆ™é€»è¾‘ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
rules:
  # 1. ç‰¹æ®Šæ£€æµ‹/å±€åŸŸç½‘
  - DOMAIN-SUFFIX,browserleaks.com,ğŸš€æ‰‹åŠ¨é€‰æ‹©
  - DOMAIN,api.groq.com,ğŸ¤–Gemini
  - RULE-SET,Lan,ğŸ¯ç›´è¿
  - RULE-SET,LanIP,ğŸ¯ç›´è¿,no-resolve

  # 2. åè®®ä¼˜åŒ–ï¼šæ‹’ç»éä¸­ UDP 443 (QUIC)
  - AND,((DST-PORT,443),(NETWORK,UDP),(NOT,((RULE-SET,ChinaIP)))),REJECT
  
  # 3. æ ¸å¿ƒåˆ†æµ
  - RULE-SET,Gemini,ğŸ¤–Gemini
  - RULE-SET,Telegram,ğŸ“²Telegram
  - RULE-SET,TelegramIP,ğŸ“²Telegram,no-resolve
  
  # 4. å›½å†…ç›´è¿
  - RULE-SET,China,ğŸ¯ç›´è¿
  - RULE-SET,ChinaIP,ğŸ¯ç›´è¿,no-resolve
  
  # 5. æœ€ç»ˆåŒ¹é…
  - MATCH,ğŸš€æ‰‹åŠ¨é€‰æ‹©
